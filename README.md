# AI 知识库 - AI Native 文档驱动的 Agent 编辑器

一个革命性的 AI 知识库应用，让运营人员**只需要用自然语言写 Markdown 文档**，AI 自动解析并生成对应的 Agent 配置。无需填写表单，无需点击按钮选择模块，就像写工作文档一样简单。

## 🎯 核心理念

### 传统方式 ❌

- 需要理解 Tool、Journey、Guideline 等技术概念
- 需要在多个表单之间切换
- 需要精确填写参数类型、返回值等技术细节
- 需要手动维护各个组件之间的关系

### AI Native 方式 ✅

**用户只需要写文档，AI 处理一切！**

```markdown
# 医疗助手 Agent

一个富有同理心、能安抚患者情绪的医疗助手。

## 工具：获取保险提供商

获取我们医院接受的保险公司列表。

返回：保险公司名称列表

## 旅程：预约挂号

帮助患者找到合适的预约时间并完成预约。

触发条件：

- 患者想要预约
- 用户说"我要挂号"

流程描述：

1. 首先了解患者就诊的原因
2. 查询近期可用的预约时间
3. 向患者展示可用时间
   ...

## 指导原则

- 患者询问保险相关问题 → 列出我们接受的保险提供商
- 患者要求与人工客服通话 → 提供办公室电话号码
```

**AI 自动解析为**：

- ✅ Agent 基本信息
- ✅ 2 个工具定义
- ✅ 1 个旅程流程
- ✅ 2 条指导原则

## 🚀 核心功能

### 1. Markdown 文档编辑

- 使用熟悉的 Markdown 格式
- 就像写工作文档、需求文档一样自然
- 实时自动保存

### 2. AI 实时解析

- 边写边解析，实时反馈
- 自动识别 Agent 组件
- 智能提取参数、条件、流程

### 3. 可视化预览

- 右侧实时预览 AI 解析结果
- 展示结构化的 Agent 配置
- 显示解析错误和警告

### 4. 审核发布流程

- 草稿 → 审核中 → 已发布 → 已归档
- 自动构建 Agent 配置
- 版本管理

## 🎨 使用示例

### 定义 Agent 基本信息

```markdown
# 客服助手

一个友好、专业的客户服务助手，能够解答常见问题并处理订单查询。
```

### 定义术语

```markdown
## 术语定义

- **VIP客户 (贵宾客户, Premium User)**: 年消费超过10000元的客户
- **工作日**: 周一至周五，上午9点至下午6点
```

### 定义工具

```markdown
## 工具：查询订单状态

根据订单号查询订单的当前状态。

参数：

- order_id: 订单编号
- user_id: 用户ID（可选）

返回：订单状态对象，包含状态、物流信息等
```

### 定义旅程

```markdown
## 旅程：处理退款请求

帮助用户完成退款流程。

触发条件：

- 用户想要退款
- 用户说"我要申请退款"

流程描述：

1. 询问订单号
2. 查询订单信息
3. 检查是否符合退款条件
4. 如果符合，引导完成退款
5. 如果不符合，说明原因并提供替代方案
```

### 定义指导原则

```markdown
## 指导原则

- 用户询问价格 → 提供最新价格并说明优惠活动
- 用户表达不满 → 表示歉意并尝试解决问题
- 用户要求人工服务 → 转接人工客服
```

## 📖 文档编写指南

### 基本结构

```markdown
# [Agent 名称]

[Agent 描述 - 性格、能力等]

## 术语定义

- **术语1 (同义词1, 同义词2)**: 说明
- **术语2**: 说明

## 工具：[工具名称]

[工具描述]

参数：

- param1: 说明
- param2 (可选): 说明

返回：[返回值说明]

## 旅程：[旅程名称]

[旅程描述]

触发条件：

- 条件1
- 条件2

流程描述：
[详细流程]

## 指导原则

- 情况A → 行动A
- 情况B → 行动B

## 观察点

[需要消歧的场景描述]
```

### 编写技巧

1. **使用自然语言**: 就像写给同事看的文档一样
2. **层次分明**: 使用 Markdown 标题组织内容
3. **简洁明了**: 重点突出，避免冗余
4. **实时反馈**: 查看右侧预览，确保 AI 正确理解

### 查看示例

查看 `/examples/healthcare-agent.md` 获取完整示例。

## 🚀 快速开始

### 安装依赖

```bash
npm install
```

### 运行开发服务器

```bash
npm run dev
```

应用将在 [http://localhost:3000](http://localhost:3000) 启动

### 构建生产版本

```bash
npm run build
npm start
```

## 🏗️ 技术架构

### 核心创新：AI Native

传统应用流程：

```
用户 → 填写表单 → 数据验证 → 保存数据库 → 生成配置
```

AI Native 流程：

```
用户 → 写 Markdown → AI 实时解析 → 生成结构化数据 → 自动配置
```

### 技术栈

- **Next.js 14**: React 框架
- **TypeScript**: 类型安全
- **Tailwind CSS**: 样式系统
- **Zustand**: 状态管理
- **Markdown Parser**: 自然语言解析
- **Lucide React**: 图标库

### 项目结构

```
ai-knowledgebase/
├── app/                    # Next.js 应用
│   ├── globals.css
│   ├── layout.tsx
│   └── page.tsx
├── components/            # React 组件
│   ├── DocumentEditor.tsx # 主编辑器
│   ├── MarkdownEditor.tsx # Markdown 编辑器
│   ├── AgentPreview.tsx   # AI 解析预览
│   ├── Header.tsx
│   └── Sidebar.tsx
├── lib/                   # 核心逻辑
│   ├── markdownParser.ts  # AI 解析器 ⭐
│   └── utils.ts
├── store/                 # 状态管理
│   └── documentStore.ts
├── types/                 # 类型定义
│   └── index.ts
├── examples/              # 示例文档
│   └── healthcare-agent.md
└── package.json
```

### AI 解析器

`lib/markdownParser.ts` 是核心组件，负责将 Markdown 文档转换为 Agent 结构：

```typescript
// 输入：Markdown 文档
const markdown = `
# 客服助手
一个友好的助手...

## 工具：查询订单
...
`;

// 输出：结构化 Agent
const result = await parseMarkdownToAgent(markdown);
// {
//   success: true,
//   agent: {
//     name: "客服助手",
//     description: "一个友好的助手...",
//     tools: [...],
//     ...
//   }
// }
```

**注意**: 当前版本使用规则匹配解析。生产环境建议集成真实的 LLM API（如 GPT-4）实现更智能的解析。

## 🔄 工作流程

```
编写 Markdown 文档 → AI 实时解析 → 预览结构 → 提交审核 → 发布 Agent
      ↓                    ↓             ↓           ↓          ↓
   自然语言            智能识别      可视化展示    人工把关    自动部署
```

### 对比：传统 vs AI Native

| 方面     | 传统方式             | AI Native      |
| -------- | -------------------- | -------------- |
| 学习成本 | 需要理解技术概念     | 会写文档就行   |
| 操作步骤 | 10+ 次点击和表单填写 | 一次性写完文档 |
| 修改效率 | 需要找到对应表单     | 直接编辑文档   |
| 可读性   | 分散在多个模块       | 一份完整文档   |
| 协作性   | 难以版本控制         | Git友好        |

## 🎨 设计理念

### 1. 文档即配置

Markdown 文档不仅是说明文档，它**就是** Agent 的配置。

### 2. AI 理解人类

人类不需要适应机器，AI 应该理解人类的自然表达。

### 3. 实时反馈

编辑即解析，让用户立即看到 AI 的理解。

### 4. 渐进式增强

- 基础版：规则匹配解析
- 进阶版：集成 LLM 智能解析
- 高级版：AI 辅助写作、自动补全

## 📝 数据持久化

当前版本使用 `localStorage` 存储文档数据。生产环境建议:

- 使用数据库（如 PostgreSQL, MongoDB）
- 实现 RESTful API 或 GraphQL
- 添加用户认证和权限管理
- 实现实时协作功能

## 🔮 未来扩展

- [ ] 集成 Novel 编辑器的高级功能（Slash 命令、AI 写作助手）
- [ ] 可视化 Journey 流程图编辑器
- [ ] Agent 性能监控和分析
- [ ] 多语言支持
- [ ] 团队协作功能
- [ ] 版本历史和回滚
- [ ] AI 辅助内容生成
- [ ] 与 Parlant SDK 的实际集成

## 📄 许可证

MIT

## 🤝 贡献

欢迎提交 Issue 和 Pull Request!
