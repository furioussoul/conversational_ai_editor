# 新功能使用指南

## ✨ 新增功能

### 1. 快捷键插入模板 (/)

在 Markdown 编辑器中，按下 `/` 键即可弹出模板选择浮窗。

**使用方法：**

1. 在编辑器中的行首或空格后按 `/` 键
2. 浮窗自动弹出，显示可用的模板
3. 搜索或浏览模板和预定义工具
4. 点击选择即可插入

**两种模式：**

#### 模块模板

- 🔧 工具定义
- 📖 术语定义
- 🗺️ 用户旅程
- 📋 行为指南
- 👁️ 观察记录
- 🤖 基础 Agent

#### 预定义工具

包含 15+ 常用工具，按分类组织：

- **数据查询**: query_database, search_documents, get_user_info
- **API调用**: call_external_api, send_email, send_sms
- **数据处理**: format_date, calculate_sum, parse_json
- **文件操作**: read_file, write_file, upload_file
- **AI功能**: generate_text, analyze_sentiment, translate_text

**工具选择流程：**

1. 切换到"预定义工具"标签
2. 左侧选择分类（或查看全部）
3. 右侧选择具体工具
4. 查看工具的参数和返回类型
5. 点击"插入工具"按钮

---

### 2. ReactFlow 可视化画布

新增画布预览模式，将解析后的 Agent 结构以流程图形式展示。

**切换视图：**

- **列表预览** 👁️ - 传统的列表式展示（原有功能）
- **画布预览** 🌐 - 新的 ReactFlow 流程图视图

**画布功能：**

#### 节点类型

每种组件都有独特的颜色和图标：

- 🟣 Agent (紫色) - 中心节点
- 🔵 Tool (蓝色) - 工具节点
- 🟢 Term (绿色) - 术语节点
- 🟠 Journey (橙色) - 旅程节点
- 🔴 Guideline (红色) - 指南节点
- 🟡 Observation (黄色) - 观察节点

#### 交互功能

- **拖动节点**: 重新排列布局
- **缩放画布**: 使用鼠标滚轮或控制面板
- **迷你地图**: 右下角显示整体布局
- **点击节点**: 打开编辑面板

#### 节点编辑

点击任意节点后，右侧会弹出编辑面板：

**Agent 节点：**

- 名称
- 描述

**Tool 节点：**

- 工具名称
- 描述
- 参数
- 返回类型

**Guideline 节点：**

- 条件 (触发条件)
- 行动 (执行动作)

**Term 节点：**

- 术语名称
- 描述
- 同义词（逗号分隔）

**Journey 节点：**

- 旅程标题
- 描述

**Observation 节点：**

- 描述

**保存修改：**
编辑完成后点击"保存"按钮，更改会自动同步到 Agent 数据结构。

---

## 🎯 典型工作流程

### 场景 1: 从零开始创建 Agent

1. 创建新文档
2. 按 `/` 选择"基础 Agent"模板
3. 填写 Agent 名称和描述
4. 继续按 `/` 添加需要的模块：
   - 添加工具（可从预定义工具选择）
   - 添加术语定义
   - 添加用户旅程
   - 添加行为指南
5. 点击"画布预览"查看整体结构
6. 在画布中点击节点进行微调

### 场景 2: 使用预定义工具

1. 按 `/` 打开模板选择器
2. 切换到"预定义工具"标签
3. 选择分类（如"数据查询"）
4. 点击具体工具（如 query_database）
5. 查看参数和返回类型
6. 点击"插入工具"
7. 工具模板自动插入到文档中
8. 根据需要调整描述和参数

### 场景 3: 可视化编辑

1. 编写 Markdown 文档
2. 点击"画布预览"按钮
3. 查看 AI 解析生成的流程图
4. 拖动节点优化布局
5. 点击节点打开编辑面板
6. 修改字段内容
7. 点击"保存"应用更改
8. 更改会同步到 Agent 数据

---

## ⌨️ 快捷键

| 快捷键 | 功能                     |
| ------ | ------------------------ |
| `/`    | 打开模板选择器           |
| `Esc`  | 关闭模板选择器或编辑面板 |

---

## 💡 最佳实践

1. **先用模板，再调整**: 使用 `/` 快速插入标准模板，然后根据实际需求调整
2. **善用预定义工具**: 15+ 预定义工具覆盖常见场景，避免重复编写
3. **列表和画布结合**: 列表预览适合查看细节，画布预览适合理解整体结构
4. **画布中微调**: 对于复杂的 Agent，可以在画布中直接编辑各个组件
5. **保持同步**: 画布编辑会更新数据，但不会自动修改 Markdown 源码

---

## 🐛 注意事项

1. 画布编辑仅修改解析后的 Agent 数据，不会反向更新 Markdown 文档
2. 如需保留画布的修改，建议手动同步回 Markdown 文档
3. 模板选择器在行首或空格后按 `/` 才会触发
4. 预定义工具插入的是模板，需要根据实际情况调整参数描述

---

## 🔄 更新内容

### 版本 1.1.0 (当前)

**新增：**

- ✅ `/` 键快捷插入模板
- ✅ 6 种模块模板
- ✅ 15+ 预定义工具库
- ✅ ReactFlow 画布预览
- ✅ 画布节点可编辑
- ✅ 列表/画布视图切换
- ✅ 彩色节点分类
- ✅ 迷你地图导航
- ✅ 拖动排列布局

**改进：**

- ⚡ 更快的模板插入体验
- 🎨 更美观的视觉呈现
- 🖱️ 更直观的交互方式

---

## 📚 相关文档

- [README.md](./README.md) - AI Native 概念说明
- [GUIDE.md](./GUIDE.md) - Markdown 编写完整指南
- [examples/healthcare-agent.md](./examples/healthcare-agent.md) - 示例文档

---

## 🚀 未来计划

- [ ] 画布编辑自动同步回 Markdown
- [ ] 更多预定义工具模板
- [ ] 自定义工具库
- [ ] 节点样式自定义
- [ ] 导出为图片
- [ ] 协作编辑标注
